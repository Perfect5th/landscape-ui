const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-5fBCUEtz.js","assets/index-BANqK6Vn.js","assets/index-zG6MToCc.css","assets/AssociationBlock-BUEhHhSw.js","assets/MultiSelectField-t015LGjx.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-DpwHb5kW.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-86H7JcHl.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-CBoJSKnz.js","assets/ProfileAssociationInfo-BuXL-x56.js","assets/PageMain-CPivTSLH.js","assets/PageMain-C_v2-kHh.css","assets/ProfileAssociatedInstancesLink-Bsdm2i87.js","assets/constants-D3vKocNj.js","assets/constants-DhSSSz5I.js","assets/table-CdFwMAPu.js","assets/HeaderWithSearch-Cjs2bK0h.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BkP3mq0s.css"])))=>i.map(i=>d[i]);
import{t as x,s as j,v as P,f as b,z as S,B as _,w as u,j as e,a9 as C,a4 as L,ad as w,aU as T,r as m,aL as E,d as v,aY as A,aV as O,N as Q,aM as F,E as M,az as N,i as $,aW as I,am as p,a7 as g}from"./index-BANqK6Vn.js";import{P as B,a as D,b as k}from"./PageMain-CPivTSLH.js";import{P as H}from"./ProfileAssociatedInstancesLink-Bsdm2i87.js";import{L as q}from"./constants-D3vKocNj.js";import{L as z}from"./constants-DhSSSz5I.js";import{u as V}from"./useRoles-CBoJSKnz.js";import{c as G}from"./table-CdFwMAPu.js";import{H as K}from"./HeaderWithSearch-Cjs2bK0h.js";function R(){const a=x(),s=j(),o=P({mutationFn:async r=>s.get("CreateRemovalProfile",{params:r}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),l=P({mutationFn:async r=>s.get("EditRemovalProfile",{params:r}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),i=P({mutationFn:async r=>s.get("RemoveRemovalProfile",{params:r}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:o,editRemovalProfileQuery:l,removeRemovalProfileQuery:i,getRemovalProfilesQuery:(r={},n={})=>b({queryKey:["removalProfiles"],queryFn:async({signal:d})=>s.get("GetRemovalProfiles",{params:r,signal:d}),...n})}}const U=({close:a,isOpen:s,removalProfile:o})=>{const l=S(),{notify:i}=_(),{setPageParams:c}=u(),{removeRemovalProfileQuery:r}=R(),{mutateAsync:n,isPending:d}=r,f=async()=>{try{await n({name:o.name}),c({sidePath:[],profile:""}),i.success({title:"Removal profile removed",message:`Removal profile ${o.title} has been removed.`})}catch(t){l(t)}finally{a()}};return e.jsx(C,{title:`Remove ${o.title}`,confirmationText:`remove ${o.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonLoading:d,onConfirm:f,close:a,isOpen:s,children:e.jsxs("p",{children:['This will remove "',o.title,'" profile. This action is ',e.jsx("b",{children:"irreversible"}),"."]})})},W=({profile:a})=>{const{createPageParamsSetter:s}=u(),{value:o,setTrue:l,setFalse:i}=L(),c=s({sidePath:["edit"],profile:a.id.toString()}),r=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:c}],n=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(w,{toggleAriaLabel:`${a.title} profile actions`,actions:r,destructiveActions:n}),e.jsx(U,{close:i,isOpen:o,removalProfile:a})]})},{getCellProps:Y,getRowProps:J}=G({headerColumnId:"title",itemTypeName:"removal profile"}),X=({profiles:a})=>{const{search:s,createPageParamsSetter:o}=u(),{getAccessGroupQuery:l}=V(),{expandedRowIndex:i,handleExpand:c,getTableRowsRef:r}=T(),{data:n}=l(),d=m.useMemo(()=>s?a.filter(t=>t.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),f=m.useMemo(()=>[{...z,meta:{ariaLabel:({original:t})=>`${t.title} profile title and name`},Cell:({row:{original:t}})=>e.jsxs(E,{children:[e.jsx(v.Button,{type:"button",appearance:"link",onClick:o({sidePath:["view"],profile:t.id.toString()}),className:"u-no-margin--bottom u-no-padding--top u-align--left","aria-label":`Open "${t.title}" profile details`,children:t.title}),e.jsx("span",{className:"u-text--muted",children:t.name})]})},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:t=>`${t.original.title} profile access group`},Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:A(t.access_group,n)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:t=>`${t.original.title} profile tags`},Cell:({row:{original:t,index:h}})=>t.tags.length>0?e.jsx(O,{content:t.tags.map(y=>e.jsx("span",{className:"truncatedItem",children:y},y)),isExpanded:h==i,onExpand:()=>{c(h)},showCount:!0}):e.jsx(Q,{})},{accessor:"associated",Header:"Associated",meta:{ariaLabel:t=>`${t.original.title} profile associated instances`},Cell:({row:{original:t}})=>e.jsx(H,{count:t.computers.num_associated_computers,profile:t,query:`removal:${t.id}`})},{...q,Cell:({row:{original:t}})=>e.jsx(W,{profile:t})}],[o,i,n,c]);return e.jsx("div",{ref:r,children:e.jsx(F,{columns:f,data:d,emptyMsg:`No removal profiles found with the search: "${s}"`,getCellProps:Y(i),getRowProps:J(i)})})},Z=()=>{const{createPageParamsSetter:a}=u();return e.jsx(M,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(v.Button,{appearance:"positive",onClick:a({sidePath:["add"],profile:""}),type:"button",children:"Add removal profile"},"table-add-new-mirror")],title:"No removal profiles found"})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(N,{filtersToDisplay:["search"]})]}),ae=()=>{const{getRemovalProfilesQuery:a}=R(),{data:s,isLoading:o}=a();return e.jsxs(e.Fragment,{children:[o&&e.jsx($,{}),!o&&(!s||s.data.length===0)&&e.jsx(Z,{}),!o&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(X,{profiles:s.data})]})]})},te=m.lazy(async()=>g(()=>import("./index-5fBCUEtz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then(a=>({default:a.RemovalProfileAddSidePanel}))),se=m.lazy(async()=>g(()=>import("./index-5fBCUEtz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then(a=>({default:a.RemovalProfileDetailsSidePanel}))),oe=m.lazy(async()=>g(()=>import("./index-5fBCUEtz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then(a=>({default:a.RemovalProfileEditSidePanel}))),re=()=>{const{sidePath:a,lastSidePathSegment:s,createPageParamsSetter:o}=u();I("sidePath",["add","edit","view"]);const l=o({sidePath:["add"],profile:""});return e.jsxs(B,{children:[e.jsx(D,{title:"Removal profiles",actions:[e.jsx(v.Button,{type:"button",appearance:"positive",onClick:l,children:"Add removal profile"},"add")]}),e.jsx(k,{children:e.jsx(ae,{})}),e.jsxs(p,{isOpen:!!a.length,onClose:o({sidePath:[],profile:""}),children:[s==="add"&&e.jsx(p.Suspense,{children:e.jsx(te,{})},"add"),s==="edit"&&e.jsx(p.Suspense,{children:e.jsx(oe,{})},"edit"),s==="view"&&e.jsx(p.Suspense,{children:e.jsx(se,{})},"view")]})]})},fe=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{U as R,X as a,Z as b,ee as c,fe as i,R as u};
