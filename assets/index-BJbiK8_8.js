const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DiBTm3Fb.js","assets/index-BANqK6Vn.js","assets/index-zG6MToCc.css","assets/AssociationBlock-BUEhHhSw.js","assets/MultiSelectField-t015LGjx.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-DpwHb5kW.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-86H7JcHl.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-CBoJSKnz.js","assets/RandomizationBlock-D-kY7k32.js","assets/RadioGroup-BLuoqCss.js","assets/RadioGroup-WBbAFTwm.css","assets/ProfileAssociationInfo-BuXL-x56.js","assets/PageMain-CPivTSLH.js","assets/PageMain-C_v2-kHh.css","assets/ProfileAssociatedInstancesLink-Bsdm2i87.js","assets/constants-D3vKocNj.js","assets/constants-DhSSSz5I.js","assets/table-CdFwMAPu.js","assets/HeaderWithSearch-Cjs2bK0h.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BBqlw6YG.css"])))=>i.map(i=>d[i]);
import{t as U,s as v,v as f,f as b,z as S,B as _,w as c,j as e,a9 as C,a4 as L,ad as w,aU as E,r as u,aL as R,d as P,aY as T,aV as A,N as F,aM as O,E as M,az as Q,i as N,aW as I,am as g,a7 as h}from"./index-BANqK6Vn.js";import{P as $,a as B,b as D}from"./PageMain-CPivTSLH.js";import{P as k}from"./ProfileAssociatedInstancesLink-Bsdm2i87.js";import{L as H}from"./constants-D3vKocNj.js";import{L as q}from"./constants-DhSSSz5I.js";import{u as z}from"./useRoles-CBoJSKnz.js";import{c as V}from"./table-CdFwMAPu.js";import{H as G}from"./HeaderWithSearch-Cjs2bK0h.js";function j(){const a=U(),s=v(),r=f({mutationFn:async o=>s.get("CreateUpgradeProfile",{params:o}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),n=f({mutationFn:async o=>s.get("EditUpgradeProfile",{params:o}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),i=f({mutationFn:async o=>s.get("RemoveUpgradeProfile",{params:o}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})});return{createUpgradeProfileQuery:r,editUpgradeProfileQuery:n,removeUpgradeProfileQuery:i,getUpgradeProfilesQuery:(o={},l={})=>b({queryKey:["upgradeProfiles",o],queryFn:async({signal:p})=>s.get("GetUpgradeProfiles",{params:o,signal:p}),...l})}}const K=({close:a,isOpen:s,upgradeProfile:r})=>{const n=S(),{notify:i}=_(),{setPageParams:d}=c(),{removeUpgradeProfileQuery:o}=j(),{mutateAsync:l,isPending:p}=o,m=async()=>{try{await l({name:r.name}),d({sidePath:[],profile:""}),i.success({title:"Upgrade profile removed",message:`Upgrade profile ${r.title} has been removed`})}catch(t){n(t)}finally{a()}};return e.jsx(C,{isOpen:s,title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonLoading:p,onConfirm:m,close:a,confirmationText:`remove ${r.title}`,children:e.jsxs("p",{children:['This will remove "',r.title,'" upgrade profile. This action is ',e.jsx("b",{children:"irreversible"}),"."]})})},W=({profile:a})=>{const{createPageParamsSetter:s}=c(),{value:r,setTrue:n,setFalse:i}=L(),d=s({sidePath:["edit"],profile:a.id.toString()}),o=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:d}],l=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" upgrade profile`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(w,{toggleAriaLabel:`${a.title} profile actions`,actions:o,destructiveActions:l}),e.jsx(K,{close:i,isOpen:r,upgradeProfile:a})]})},{getCellProps:Y,getRowProps:J}=V({headerColumnId:"title",itemTypeName:"upgrade profile"}),X=({profiles:a})=>{const{search:s}=c(),{createPageParamsSetter:r}=c(),{getAccessGroupQuery:n}=z(),{expandedRowIndex:i,handleExpand:d,getTableRowsRef:o}=E(),{data:l}=n(),p=u.useMemo(()=>s?a.filter(t=>t.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),m=u.useMemo(()=>[{...q,meta:{ariaLabel:({original:t})=>`${t.title} profile title and name`},Cell:({row:{original:t}})=>e.jsxs(R,{children:[e.jsx(P.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:r({sidePath:["view"],profile:t.id.toString()}),children:t.title}),e.jsx("span",{className:"u-text--muted",children:t.name})]})},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:({original:t})=>`${t.title} profile access group`},Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:T(t.access_group,l)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:t})=>`${t.title} profile tags`,isExpandable:!0},Cell:({row:{original:t,index:x}})=>t.tags.length>0?e.jsx(A,{content:t.tags.map(y=>e.jsx("span",{className:"truncatedItem",children:y},y)),isExpanded:x==i,onExpand:()=>{d(x)},showCount:!0}):e.jsx(F,{})},{accessor:"associated",Header:"Associated",meta:{ariaLabel:({original:t})=>`${t.title} profile associated instances`},Cell:({row:{original:t}})=>e.jsx(k,{count:t.computers.num_associated_computers,profile:t,query:`upgrade:${t.id}`})},{...H,Cell:({row:{original:t}})=>e.jsx(W,{profile:t})}],[r,i,l,d]);return e.jsx("div",{ref:o,children:e.jsx(O,{columns:m,data:p,emptyMsg:`No upgrade profiles found with the search: "${s}"`,getCellProps:Y(i),getRowProps:J(i)})})},Z=()=>{const{createPageParamsSetter:a}=c(),s=a({sidePath:["add"]});return e.jsx(M,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any upgrade profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(P.Button,{appearance:"positive",onClick:s,type:"button",children:"Add upgrade profile"},"table-add-new-mirror")],title:"No upgrade profiles found"})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsx(Q,{filtersToDisplay:["search"]})]}),ae=()=>{const{getUpgradeProfilesQuery:a}=j(),{data:s,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(N,{}),!r&&(!s||!s.data.length)&&e.jsx(Z,{}),!r&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(X,{profiles:s.data})]})]})},te=u.lazy(()=>h(()=>import("./index-DiBTm3Fb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(a=>({default:a.UpgradeProfileAddSidePanel}))),se=u.lazy(()=>h(()=>import("./index-DiBTm3Fb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(a=>({default:a.UpgradeProfileDetailsSidePanel}))),re=u.lazy(()=>h(()=>import("./index-DiBTm3Fb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(a=>({default:a.UpgradeProfileEditSidePanel}))),oe=()=>{const{sidePath:a,lastSidePathSegment:s,createPageParamsSetter:r}=c();I("sidePath",["add","edit","view"]);const n=r({sidePath:["add"]});return e.jsxs($,{children:[e.jsx(B,{title:"Upgrade profiles",actions:[e.jsx(P.Button,{type:"button",appearance:"positive",onClick:n,children:"Add upgrade profile"},"add")]}),e.jsx(D,{children:e.jsx(ae,{})}),e.jsxs(g,{onClose:r({sidePath:[],profile:""}),isOpen:!!a.length,children:[s==="add"&&e.jsx(g.Suspense,{children:e.jsx(te,{})},"add"),s==="edit"&&e.jsx(g.Suspense,{children:e.jsx(re,{})},"edit"),s==="view"&&e.jsx(g.Suspense,{children:e.jsx(se,{})},"view")]})]})},me=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));export{K as U,X as a,Z as b,ee as c,me as i,j as u};
