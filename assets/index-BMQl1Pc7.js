import{A as W,u as X,a as Y}from"./index-Ca63uu9B.js";import{ag as h,y as T,z as G,C as f,H as j,o as r,j as e,d as o,F as a}from"./index-BANqK6Vn.js";import{S as E}from"./SidePanelFormButtons-86H7JcHl.js";import{u as F}from"./useGPGKeys-DiID6MPL.js";import{t as u}from"./tests-DFnZqbNV.js";import{u as I}from"./useRoles-CBoJSKnz.js";import{u as L}from"./useAPTSources-DrazqMKm.js";import"./PageMain-CPivTSLH.js";import"./constants-D3vKocNj.js";import"./RepositoryProfileListActions-25u7WJy7.js";import"./ModalTablePagination-BmaqyO-k.js";import"./constants-GGztYKoV.js";import"./SidePanelFormButtons.module-CcPyiogC.js";const k={name:"",apt_line:"",gpg_key:"",access_group:h},N="Enter 'deb', followed by the URI for the repository mirror, distribution and components. An example entry could be 'deb http://landscape-repo-mirror/repository/standalone/ubuntu jammy main universe restricted multiverse'",q="_tooltipPositionElement_1cfe6_1",v={tooltipPositionElement:q},z=()=>{const{closeSidePanel:c}=T(),l=G(),{createAPTSourceQuery:p,getAPTSourcesQuery:m}=L(),{getGPGKeysQuery:d}=F(),{data:g,isLoading:P}=d(),{getAccessGroupQuery:y}=I(),{data:b,isLoading:A}=y(),S=(b?.data??[]).map(t=>({label:t.title,value:t.name})),_=(g?.data??[]).map(({name:t})=>({label:t,value:t})),{mutateAsync:x}=p,{data:n}=m(),s=f({initialValues:k,validationSchema:j().shape({name:r().required("This field is required").test({test:u.test,message:u.message}).test({params:{getAPTSourcesResponse:n},test:t=>!(n?.data??[]).map(({name:i})=>i).includes(t),message:"It must be unique within the account."}),apt_line:r().required("This field is required"),gpg_key:r(),access_group:r()}),onSubmit:async t=>{try{await x(t),c()}catch(i){l(i)}}});return e.jsxs(o.Form,{onSubmit:s.handleSubmit,noValidate:!0,children:[e.jsx(o.Input,{type:"text",label:"Name",required:!0,error:a(s,"name"),...s.getFieldProps("name")}),e.jsx(o.Input,{type:"text",label:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"APT Line"}),e.jsxs(o.Tooltip,{message:N,positionElementClassName:v.tooltipPositionElement,children:[e.jsx(o.Icon,{name:"help","aria-hidden":!0}),e.jsx("span",{className:"u-off-screen",children:"Help"})]})]}),required:!0,error:a(s,"apt_line"),...s.getFieldProps("apt_line")}),e.jsx(o.Select,{label:"GPG key",disabled:P,options:[{label:"Select GPG key",value:""},..._],...s.getFieldProps("gpg_key"),error:a(s,"gpg_key")}),e.jsx(o.Select,{label:"Access group",disabled:A,options:S,...s.getFieldProps("access_group"),error:a(s,"access_group")}),e.jsx(E,{submitButtonDisabled:s.isSubmitting,submitButtonText:"Add APT source"})]})};export{W as APTSourcesList,z as NewAPTSourceForm,L as useAPTSources,X as useGetAPTSources,Y as useRemoveAPTSource};
